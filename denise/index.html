<!DOCTYPE html>

<html lang="de" xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
<meta charset="utf-8">

<head>
    <title>
        Denise (HTML title)
    </title>

    <script>

        let element_audio = {}
        let element_speed = {}
        let element_position = {};
        let element_heading = {};
        let element_altitude = {};

        function run() {

            element_audio = document.getElementById("audio");
            element_speed = document.getElementById("speed");
            element_position = document.getElementById("position");
            element_heading = document.getElementById("heading");
            element_altitude = document.getElementById("altitude");

            console.log("running")

            if (!navigator.geolocation) {
                element_speed.innerHTML = "Geolocation is not supported by your browser";
            } else {
                //const watchID = navigator.geolocation.watchPosition(positionChanged)
                console.log("set interval")
                setInterval(updatePosition, 1000)
            }

            /*
                        let count = 0
            
                        setInterval(() => {
                            count++;
                            const el = document.getElementById("audio_element");
                            el.title = "Denise + " + count;
                        }, 7000)
            */
        }

        function positionChanged(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            const altitude = position.coords.altitude;
            const speed = position.coords.speed * 3.6;
            const heading = position.coords.heading
            console.log(speed + " km/h")
            console.log(`Latitude: ${latitude} 째, Longitude: ${longitude} 째`)
            console.log("Altitude = " + altitude)
            console.log(heading)

            element_speed.innerHTML = speed + " km/h"
            element_position.innerHTML = `Latitude: ${latitude} 째, Longitude: ${longitude} 째`;
            element_heading.innerHTML = heading

            element_audio.title = "NK: " + speed + "km/h, heading=" + heading + ", " + latitude + "/" + longitude

        }

        function updatePosition() {
            console.log("updatePosition at " + Date.now())
            navigator.geolocation.getCurrentPosition(positionChanged, () => { element_speed.innerHTML = "getCurrentposition failed" })
        }


    </script>

</head>


<body onload="run()">

    <audio id="audio" controls autoplay loop src="denise.mp3" title="Denise (title in the audio tag)"></audio>

    <p>.</p>
    <p>.</p>
    <p>.</p>
    <p>.</p>

    <dl>
        <dt>Speed:</dt>
        <dd>
            <div id="speed"> </div>
        </dd>

        <dt>Position:</dt>
        <dd>
            <div id="position"> </div>
        </dd>

        <dt>Altitude:</dt>
        <dd>
            <div id="altitude"> </div>
        </dd>

        <dt>Heading:</dt>
        <dd>
            <div id="heading"> </div>
        </dd>
    </dl>



</body>

</html>